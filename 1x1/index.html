<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>1 x 1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --bg1:#f8fafc; --bg2:#e2e8f0; --card:#ffffff;
      --text:#0f172a; --muted:#64748b; --border:#e2e8f0;
      --shadow: 0 18px 50px rgba(15,23,42,.10);
      --accent:#2563eb;
      --ok-bg:#ecfdf5; --ok-text:#047857; --ok-border:#34d399;
      --bad-bg:#fef2f2; --bad-text:#b91c1c; --bad-border:#fca5a5;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .shell{
      width:min(640px, 100%);
      background:var(--card);
      border:1px solid var(--border);
      border-radius:22px;
      box-shadow:var(--shadow);
      padding:22px;
    }

    .list{ display:grid; gap:10px; padding:4px; }

    .row{
      height:64px;
      display:flex;
      align-items:center;
      gap:14px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:16px;
      background:#fff;
      transition: background-color .18s ease, border-color .18s ease, color .18s ease;
    }

    .expr{
      flex: 1;
      font-size:28px;
      font-weight:650;
      letter-spacing:.2px;
      text-align:left;
      padding-left:4px;
    }

    .eq{
      font-size:22px;
      color:var(--muted);
      font-weight:600;
      user-select:none;
    }

    .ans{
      width:112px;
      height:44px;
      border-radius:14px;
      border:1.5px solid var(--border);
      background:#fff;
      color:var(--text);
      font-size:22px;
      font-weight:700;
      text-align:center;
      outline:none;
      transition: box-shadow .18s ease, border-color .18s ease, background-color .18s ease, color .18s ease;
    }
    .ans:focus{
      border-color: rgba(37,99,235,.65);
      box-shadow: 0 0 0 4px rgba(37,99,235,.14);
    }

    .row.ok{
      background:var(--ok-bg);
      border-color: rgba(52,211,153,.55);
      color:var(--ok-text);
    }
    .row.ok .eq{ color: rgba(4,120,87,.75); }
    .row.ok .ans{
      background: rgba(255,255,255,.8);
      border-color: var(--ok-border);
      color: var(--ok-text);
      box-shadow: 0 0 0 4px rgba(16,185,129,.12);
    }

    .row.bad{
      background:var(--bad-bg);
      border-color: rgba(252,165,165,.65);
      color:var(--bad-text);
    }
    .row.bad .eq{ color: rgba(185,28,28,.75); }
    .row.bad .ans{
      background: rgba(255,255,255,.85);
      border-color: var(--bad-border);
      color: var(--bad-text);
      box-shadow: 0 0 0 4px rgba(239,68,68,.12);
    }

    .ans[readonly]{ cursor:default; }

    .footer{
      display:flex;
      align-items:center;
      justify-content:center;
      padding-top:16px;
    }

    .fab{
      width:64px;
      height:64px;
      border-radius:18px;
      border:0;
      cursor:pointer;
      background:var(--accent);
      color:#fff;
      box-shadow: 0 14px 34px rgba(37,99,235,.30);
      transition: transform .15s ease, box-shadow .15s ease, background-color .15s ease;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .fab:hover{ transform: translateY(-1px); box-shadow: 0 18px 42px rgba(37,99,235,.36); }
    .fab:active{ transform: translateY(1px); }
    .fab.secondary{
      background:#f1f5f9;
      color:#1d4ed8;
      box-shadow: 0 10px 26px rgba(15,23,42,.08);
    }

    .icon{ width:26px; height:26px; display:block; }

    /* fullscreen iframe */
    #game-frame{
      position:fixed;
      inset:0;
      width:100vw;
      height:100vh;
      border:none;
      display:none;
      background:#000;
      z-index:9999;
    }

    /* Invisible edge buttons (only shown in game mode) */
    .edge{
      position:fixed;
      top:0;
      height:100vh;
      width:72px;          /* tweak: wider = easier to hit */
      opacity:0;           /* invisible but clickable */
      background:transparent;
      border:0;
      padding:0;
      margin:0;
      z-index:10000;       /* above iframe */
      pointer-events:auto;
      cursor:default;
      display:none;
    }
    #edge-left{ left:0; }
    #edge-right{ right:0; }

    @media (max-width:520px){
      .row{ height:60px; }
      .expr{ font-size:24px; }
      .ans{ width:96px; font-size:20px; }
      .edge{ width:84px; }
    }
  </style>
</head>
<body>
  <main id="app" class="shell" aria-label="Math practice">
    <section class="list">
      <div class="row" data-i="0">
        <div class="expr" id="expr0">—</div>
        <div class="eq">=</div>
        <input class="ans" id="ans0" inputmode="numeric" autocomplete="off" />
      </div>
      <div class="row" data-i="1">
        <div class="expr" id="expr1">—</div>
        <div class="eq">=</div>
        <input class="ans" id="ans1" inputmode="numeric" autocomplete="off" />
      </div>
      <div class="row" data-i="2">
        <div class="expr" id="expr2">—</div>
        <div class="eq">=</div>
        <input class="ans" id="ans2" inputmode="numeric" autocomplete="off" />
      </div>
      <div class="row" data-i="3">
        <div class="expr" id="expr3">—</div>
        <div class="eq">=</div>
        <input class="ans" id="ans3" inputmode="numeric" autocomplete="off" />
      </div>
    </section>

    <div class="footer">
      <button id="btn" class="fab" title="Check" aria-label="Check">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
  </main>

  <iframe
    id="game-frame"
    src="about:blank"
    loading="eager"
    allow="fullscreen"
    sandbox="allow-scripts allow-same-origin allow-fullscreen allow-presentation allow-pointer-lock allow-downloads"
    referrerpolicy="no-referrer"
  ></iframe>

  <!-- invisible edge buttons to exit game -->
  <button id="edge-left" class="edge" aria-label="Exit game (left)"></button>
  <button id="edge-right" class="edge" aria-label="Exit game (right)"></button>

  <script>
    const GAME_URL = "https://brainplay.com/p/dinosaur-game";
    const SECRET = [1,7,8,9];

    const exprEls = [0,1,2,3].map(i => document.getElementById(`expr${i}`));
    const ansEls  = [0,1,2,3].map(i => document.getElementById(`ans${i}`));
    const rowEls  = [0,1,2,3].map(i => document.querySelector(`.row[data-i="${i}"]`));
    const btn     = document.getElementById('btn');
    const app     = document.getElementById('app');
    const frame   = document.getElementById('game-frame');

    const edgeLeft  = document.getElementById('edge-left');
    const edgeRight = document.getElementById('edge-right');

    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

    // Only multiplication up to 12x12, and division as its reverse.
    function makeFact(){
      const a = randInt(1,12);
      const b = randInt(1,12);
      const p = a * b;

      if (Math.random() < 0.5) return { expr: `${a} × ${b}`, answer: p };
      if (Math.random() < 0.5) return { expr: `${p} ÷ ${a}`, answer: b };
      return { expr: `${p} ÷ ${b}`, answer: a };
    }

    let qs = [];

    function setModeCheck(){
      btn.classList.remove('secondary');
      btn.title = "Check";
      btn.setAttribute("aria-label","Check");
      btn.innerHTML = `
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
      btn.onclick = onCheck;
    }

    function setModeNext(){
      btn.classList.add('secondary');
      btn.title = "Next";
      btn.setAttribute("aria-label","Next");
      btn.innerHTML = `
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M8 5l8 7-8 7" stroke="currentColor" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
      btn.onclick = onNext;
    }

    function newRound(){
      qs = [makeFact(), makeFact(), makeFact(), makeFact()];
      exprEls.forEach((el,i) => el.textContent = qs[i].expr);

      rowEls.forEach(r => r.classList.remove('ok','bad'));
      ansEls.forEach(a => { a.value = ""; a.removeAttribute("readonly"); });

      setModeCheck();
      ansEls[0].focus();
    }

    function getAnswers(){
      return ansEls.map(a => {
        const v = String(a.value ?? "").trim();
        return v === "" ? NaN : Number(v);
      });
    }

    function inGameMode(on){
      frame.style.display = on ? "block" : "none";
      edgeLeft.style.display = on ? "block" : "none";
      edgeRight.style.display = on ? "block" : "none";
    }

    function forwardToGame(){
      app.style.display = "none";
      frame.src = GAME_URL;
      inGameMode(true);
    }

    function exitGame(){
      // hide game, show quiz, start fresh round
      inGameMode(false);
      frame.src = "about:blank"; // stop game audio/CPU in many browsers
      app.style.display = "block";
      newRound();
    }

    function onCheck(){
      const answers = getAnswers();

      // Secret code forwards immediately; no corrections.
      const isSecret = answers.every((v,i) => v === SECRET[i]);
      if (isSecret) { forwardToGame(); return; }

      // lock + highlight
      answers.forEach((v,i) => {
        ansEls[i].setAttribute("readonly","readonly");
        rowEls[i].classList.add(v === qs[i].answer ? "ok" : "bad");
      });

      setModeNext();
    }

    function onNext(){ newRound(); }

    // Edge exit interactions
    edgeLeft.addEventListener("click", exitGame);
    edgeRight.addEventListener("click", exitGame);

    // Optional: Escape to exit game quickly
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && frame.style.display === "block") exitGame();
    });

    // Enter triggers check/next when in quiz
    ansEls.forEach((el) => el.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && app.style.display !== "none") btn.click();
    }));

    newRound();
  </script>
</body>
</html>
